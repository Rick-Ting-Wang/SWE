{#
  Komodo Hub - Form Component Macros

  This file contains reusable Jinja2 macros for consistent form elements
  across all templates. Use these macros to ensure spacing consistency.
#}

{# Standard form input field with icon and helper text #}
{% macro form_input_icon_text(name, label, placeholder='', type='text', required=false, icon='', helper_text='') %}
<div class="form-field">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <div class="relative">
        <div class="form-icon-group" id="{{ name }}-icon-group">
            <div class="flex items-center">
                {% if icon %}
                <svg class="form-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    {{ icon|safe }}
                </svg>
                {% endif %}
                {% if helper_text %}
                <span class="form-icon-text">{{ helper_text }}</span>
                {% endif %}
            </div>
        </div>
        <input
            type="{{ type }}"
            name="{{ name }}"
            id="{{ name }}"
            {% if required %}required{% endif %}
            class="form-input-icon-text"
            placeholder="{{ placeholder }}"
            onfocus="hideIconGroup('{{ name }}-icon-group')"
            onblur="showIconGroup('{{ name }}-icon-group', this.value)"
        >
    </div>
</div>
{% endmacro %}

{# Form input field with icon only (no helper text) #}
{% macro form_input_icon_only(name, label, placeholder='', type='text', required=false, icon='') %}
<div class="form-field">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <div class="relative">
        {% if icon %}
        <div class="form-icon-only" id="{{ name }}-icon-group">
            <svg class="form-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                {{ icon|safe }}
            </svg>
        </div>
        {% endif %}
        <input
            type="{{ type }}"
            name="{{ name }}"
            id="{{ name }}"
            {% if required %}required{% endif %}
            class="form-input-icon-only"
            placeholder="{{ placeholder }}"
            {% if icon %}
            onfocus="hideIconGroup('{{ name }}-icon-group')"
            onblur="showIconGroup('{{ name }}-icon-group', this.value)"
            {% endif %}
        >
    </div>
</div>
{% endmacro %}

{# Standard form input field without icons #}
{% macro form_input_standard(name, label, placeholder='', type='text', required=false) %}
<div class="form-field">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <input
        type="{{ type }}"
        name="{{ name }}"
        id="{{ name }}"
        {% if required %}required{% endif %}
        class="form-input-standard"
        placeholder="{{ placeholder }}"
    >
</div>
{% endmacro %}

{# Form textarea field #}
{% macro form_textarea(name, label, placeholder='', rows=4, required=false, helper_text='') %}
<div class="form-field{% if helper_text %}-with-help{% endif %}">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <textarea
        name="{{ name }}"
        id="{{ name }}"
        rows="{{ rows }}"
        {% if required %}required{% endif %}
        class="form-textarea"
        placeholder="{{ placeholder }}"
    ></textarea>
    {% if helper_text %}
    <p class="form-help-text">{{ helper_text }}</p>
    {% endif %}
</div>
{% endmacro %}

{# Form select dropdown field #}
{% macro form_select(name, label, options=[], required=false, helper_text='', icon='') %}
<div class="form-field{% if helper_text %}-with-help{% endif %}">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <div class="relative">
        {% if icon %}
        <div class="form-icon-group" id="{{ name }}-icon-group">
            <div class="flex items-center">
                <svg class="form-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    {{ icon|safe }}
                </svg>
                {% if helper_text %}
                <span class="form-icon-text">{{ helper_text }}</span>
                {% endif %}
            </div>
        </div>
        {% endif %}
        <select
            name="{{ name }}"
            id="{{ name }}"
            {% if required %}required{% endif %}
            class="{% if icon %}form-select{% else %}form-select-standard{% endif %}"
            {% if icon %}
            onfocus="hideIconGroup('{{ name }}-icon-group')"
            onblur="showIconGroup('{{ name }}-icon-group', this.value)"
            {% endif %}
        >
            {% for option in options %}
            <option value="{{ option.value }}">{{ option.label }}</option>
            {% endfor %}
        </select>
    </div>
    {% if helper_text and not icon %}
    <p class="form-help-text">{{ helper_text }}</p>
    {% endif %}
</div>
{% endmacro %}

{# Form checkbox field #}
{% macro form_checkbox(name, label, checked=false, helper_text='') %}
<div class="form-field{% if helper_text %}-with-help{% endif %}">
    <div class="flex items-start">
        <div class="flex items-center h-5">
            <input
                type="checkbox"
                name="{{ name }}"
                id="{{ name }}"
                {% if checked %}checked{% endif %}
                class="focus:ring-conservation-500 h-4 w-4 text-conservation-600 border-gray-300 rounded"
            >
        </div>
        <div class="ml-3 text-sm">
            <label for="{{ name }}" class="font-medium text-gray-700">
                {{ label }}
            </label>
            {% if helper_text %}
            <p class="text-gray-500">{{ helper_text }}</p>
            {% endif %}
        </div>
    </div>
</div>
{% endmacro %}

{# Form number input field #}
{% macro form_number(name, label, min=1, max=100, value='', required=false, helper_text='') %}
<div class="form-field{% if helper_text %}-with-help{% endif %}">
    <label for="{{ name }}" class="form-label{% if required %}-required{% endif %}">
        {{ label }}
    </label>
    <input
        type="number"
        name="{{ name }}"
        id="{{ name }}"
        min="{{ min }}"
        max="{{ max }}"
        {% if value %}value="{{ value }}"{% endif %}
        {% if required %}required{% endif %}
        class="form-input-standard"
    >
    {% if helper_text %}
    <p class="form-help-text">{{ helper_text }}</p>
    {% endif %}
</div>
{% endmacro %}

{# Form button primary #}
{% macro form_button_primary(text, icon='') %}
<button type="submit" class="form-button-primary">
    {% if icon %}
    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        {{ icon|safe }}
    </svg>
    {% endif %}
    {{ text }}
</button>
{% endmacro %}

{# Form button secondary #}
{% macro form_button_secondary(text, icon='') %}
<button type="button" class="form-button-secondary">
    {% if icon %}
    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        {{ icon|safe }}
    </svg>
    {% endif %}
    {{ text }}
</button>
{% endmacro %}

{# Form container wrapper #}
{% macro form_container(content) %}
<div class="form-container">
    {{ content|safe }}
</div>
{% endmacro %}

{# Form section wrapper #}
{% macro form_section(content) %}
<div class="form-section">
    {{ content|safe }}
</div>
{% endmacro %}

{# Form subsection wrapper #}
{% macro form_subsection(title, content) %}
<div class="form-subsection">
    {% if title %}
    <h3 class="text-sm font-medium text-gray-900 mb-3">{{ title }}</h3>
    {% endif %}
    {{ content|safe }}
</div>
{% endmacro %}

{# Form actions wrapper #}
{% macro form_actions(content) %}
<div class="form-actions">
    {{ content|safe }}
</div>
{% endmacro %}

{# Icon SVG paths for common icons #}
{% macro icon_user() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
{% endmacro %}

{% macro icon_email() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"/>
{% endmacro %}

{% macro icon_password() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
{% endmacro %}

{% macro icon_organization() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
{% endmacro %}

{% macro icon_course() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
{% endmacro %}

{% macro icon_content() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
{% endmacro %}

{% macro icon_upload() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
{% endmacro %}

{% macro icon_login() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
{% endmacro %}

{% macro icon_add() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
{% endmacro %}

{% macro icon_back() %}
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
{% endmacro %}

{# JavaScript functions for icon group interactions #}
{% macro form_javascript() %}
<script>
// Function to hide icon group when input is focused
function hideIconGroup(groupId) {
    const iconGroup = document.getElementById(groupId);
    if (iconGroup) {
        iconGroup.style.opacity = '0';
        iconGroup.style.transition = 'opacity 0.2s ease-in-out';
    }
}

// Function to show icon group when input loses focus and is empty
function showIconGroup(groupId, inputValue) {
    const iconGroup = document.getElementById(groupId);
    if (iconGroup && !inputValue.trim()) {
        iconGroup.style.opacity = '1';
    }
}
</script>
{% endmacro %}